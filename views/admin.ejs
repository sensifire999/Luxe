<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Master Admin | LuxeStore</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: #0f172a; color: #f8fafc; }
        .glass { background: rgba(30, 41, 59, 0.7); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.05); }
        .gradient-border { border: 2px solid transparent; background-image: linear-gradient(#0f172a, #0f172a), radial-gradient(circle at top left, #3b82f6,#9333ea); background-origin: border-box; background-clip: padding-box, border-box; }
        .stat-card { transition: transform 0.3s ease; }
        .stat-card:hover { transform: translateY(-5px); }
    </style>
</head>
<body class="p-4 md:p-8 min-h-screen">

    <div class="max-w-7xl mx-auto">
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-6 mb-12">
            <div>
                <h1 class="text-4xl font-black italic tracking-tighter uppercase">Luxe <span class="text-blue-500">Command</span> Center</h1>
                <p class="text-slate-400 text-xs font-bold uppercase tracking-[4px] mt-2">Welcome Back, Chief Admin</p>
            </div>
            <div class="flex gap-4">
                <a href="/" class="glass px-6 py-3 rounded-2xl font-black text-[10px] uppercase tracking-widest hover:bg-white/10 transition-all">Storefront</a>
                <a href="/logout" class="bg-red-500/10 text-red-500 border border-red-500/20 px-6 py-3 rounded-2xl font-black text-[10px] uppercase tracking-widest">Sign Out</a>
            </div>
        </div>

        <div class="grid grid-cols-2 lg:grid-cols-4 gap-6 mb-12">
            <div class="glass p-6 rounded-[32px] stat-card">
                <p class="text-[10px] font-bold text-slate-500 uppercase tracking-widest">Total Revenue</p>
                <h3 class="text-3xl font-black mt-2 text-blue-400">‚Çπ<%= stats.sales %></h3>
            </div>
            <div class="glass p-6 rounded-[32px] stat-card">
                <p class="text-[10px] font-bold text-slate-500 uppercase tracking-widest">Advance Recv.</p>
                <h3 class="text-3xl font-black mt-2 text-emerald-400">‚Çπ<%= stats.advance %></h3>
            </div>
            <div class="glass p-6 rounded-[32px] stat-card">
                <p class="text-[10px] font-bold text-slate-500 uppercase tracking-widest">Live Orders</p>
                <h3 class="text-3xl font-black mt-2"><%= stats.ordersCount %></h3>
            </div>
            <div class="glass p-6 rounded-[32px] stat-card">
                <p class="text-[10px] font-bold text-slate-500 uppercase tracking-widest">Active Users</p>
                <h3 class="text-3xl font-black mt-2"><%= stats.users %></h3>
            </div>
        </div>

        <div class="grid lg:grid-cols-12 gap-10">
            <div class="lg:col-span-8 space-y-8">
                <div class="flex items-center justify-between">
                    <h2 class="text-xl font-black uppercase italic tracking-widest">Recent Orders</h2>
                    <div class="h-[1px] flex-1 bg-white/5 mx-6"></div>
                </div>

                <div class="space-y-4">
                    <% orders.forEach(order => { %>
                        <div class="glass p-6 rounded-[35px] border-l-4 border-blue-500 hover:bg-white/5 transition-all">
                            <div class="flex flex-col md:flex-row justify-between gap-4">
                                <div>
                                    <div class="flex items-center gap-3 mb-2">
                                        <span class="text-[9px] font-black bg-blue-600 px-3 py-1 rounded-full uppercase">#<%= order.id %></span>
                                        <span class="text-[9px] font-bold text-slate-500 uppercase tracking-widest"><%= order.date %></span>
                                    </div>
                                    <h4 class="text-lg font-black uppercase tracking-tight"><%= order.fullname %></h4>
                                    <p class="text-xs text-slate-400 font-medium mt-1 mb-3"><%= order.address %></p>
                                    <div class="flex items-center gap-2">
                                        <span class="text-[10px] font-black text-emerald-400">UTR: <%= order.utr %></span>
                                    </div>
                                </div>
                                <div class="text-right flex flex-col justify-between">
                                    <select onchange="updateStatus('<%= order.id %>', this.value)" 
                                            class="bg-slate-800 border-none rounded-xl text-[10px] font-black p-3 outline-none uppercase tracking-widest">
                                        <option value="üïí Pending" <%= order.status === 'üïí Pending' ? 'selected' : '' %>>üïí Pending</option>
                                        <option value="üöö Shipped" <%= order.status === 'üöö Shipped' ? 'selected' : '' %>>üöö Shipped</option>
                                        <option value="‚úÖ Delivered" <%= order.status === '‚úÖ Delivered' ? 'selected' : '' %>>‚úÖ Delivered</option>
                                        <option value="‚ùå Cancelled" <%= order.status === '‚ùå Cancelled' ? 'selected' : '' %>>‚ùå Cancelled</option>
                                    </select>
                                    <p class="text-2xl font-black text-blue-400 mt-4">‚Çπ<%= order.advance %></p>
                                </div>
                            </div>
                        </div>
                    <% }) %>
                </div>
            </div>

            <div class="lg:col-span-4 space-y-10">
                <div class="gradient-border p-8 rounded-[40px]">
                    <h2 class="text-lg font-black uppercase italic mb-6 tracking-widest">Inventory Add</h2>
                    <form action="/admin/add-product" method="POST" class="space-y-4">
                        <input type="text" name="name" placeholder="PRODUCT NAME" class="w-full bg-slate-800/50 border-none rounded-2xl p-4 text-xs font-bold outline-none focus:ring-2 focus:ring-blue-500" required>
                        <input type="number" name="price" placeholder="PRICE (INR)" class="w-full bg-slate-800/50 border-none rounded-2xl p-4 text-xs font-bold outline-none focus:ring-2 focus:ring-blue-500" required>
                        <input type="text" name="images" placeholder="IMAGE URLS (Comma separated)" class="w-full bg-slate-800/50 border-none rounded-2xl p-4 text-xs font-bold outline-none focus:ring-2 focus:ring-blue-500" required>
                        <textarea name="desc" placeholder="PRODUCT DESCRIPTION" class="w-full bg-slate-800/50 border-none rounded-2xl p-4 text-xs font-bold outline-none focus:ring-2 focus:ring-blue-500" rows="3"></textarea>
                        <button class="w-full bg-blue-600 hover:bg-blue-700 py-5 rounded-2xl font-black text-[10px] uppercase tracking-[3px] shadow-xl transition-all active:scale-95">Push to Store</button>
                    </form>
                </div>

                <div class="glass p-8 rounded-[40px]">
                    <h2 class="text-lg font-black uppercase italic mb-6 tracking-widest text-slate-400">Current Items</h2>
                    <div class="space-y-4 max-h-[400px] overflow-y-auto pr-2 custom-scrollbar">
                        <% products.forEach(p => { %>
                            <div class="flex items-center justify-between p-4 bg-white/5 rounded-2xl border border-white/5">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 rounded-lg overflow-hidden bg-slate-700">
                                        <img src="<%= Array.isArray(p.images) ? p.images[0] : p.image %>" class="w-full h-full object-cover">
                                    </div>
                                    <p class="text-[11px] font-black uppercase truncate w-24"><%= p.name %></p>
                                </div>
                                <button onclick="deleteProduct('<%= p.id %>')" class="text-red-500 hover:bg-red-500/10 p-2 rounded-xl transition-all">
                                    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"><path d="M3 6h18m-2 0v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"/></svg>
                                </button>
                            </div>
                        <% }) %>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function updateStatus(orderId, status) {
            fetch('/admin/update-status', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ orderId, status })
            }).then(() => {
                alert('üöÄ Status Updated Successfully');
                location.reload();
            });
        }

        function deleteProduct(id) {
            if(confirm('üö® Warning: Product will be removed permanently. Proceed?')) {
                fetch('/admin/delete-product', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ id })
                }).then(() => location.reload());
            }
        }
    </script>
</body>
</html>

